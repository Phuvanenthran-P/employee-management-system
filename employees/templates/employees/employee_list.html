{% extends "base.html" %}
{% block title %}Employees{% endblock %}

{% block content %}
<h1>Employees</h1>

{% if perms.employees.add_employee %}
    <a href="{% url 'employee_create' %}">
        <button class="btn-primary">Add Employee</button>
    </a>
{% endif %}

<br><br>

<form method="get">
    <input type="text" name="q" placeholder="Search by name or role">
    <button class="btn-primary">Search</button>
</form>

<br>

<table>
    <tr>
        <th>Name</th>
        <th>Role</th>
        <th>Salary</th>
        <th>Actions</th>
    </tr>

    {% for emp in employees %}
    <tr>
        <td>{{ emp.name }}</td>
        <td>{{ emp.role }}</td>
        <td>â‚¹{{ emp.salary }}</td>
        <td>
            {% if perms.employees.change_employee %}
                <a href="{% url 'employee_update' emp.id %}">Edit</a>
            {% endif %}
            {% if perms.employees.delete_employee %}
                |
                <a href="{% url 'employee_delete' emp.id %}">Delete</a>
            {% endif %}
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="4">No employees found.</td>
    </tr>
    {% endfor %}
</table>
<div style="margin-top: 20px;">
    {% if is_paginated %}
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">
                Previous
            </a>
        {% endif %}

        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">
                Next
            </a>
        {% endif %}
    {% endif %}
</div>

{% endblock %}
